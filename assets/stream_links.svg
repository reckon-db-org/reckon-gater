<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <marker id="linkArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8B5CF6"/>
    </marker>
    <linearGradient id="sourceGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2563EB;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="linkGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8B5CF6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7C3AED;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="targetGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
  </defs>

  <style>
    .title { font: bold 16px sans-serif; fill: #1F2937; }
    .stream-title { font: bold 11px sans-serif; fill: white; }
    .event { font: 10px sans-serif; fill: #374151; }
    .event-filtered { font: 10px sans-serif; fill: #9CA3AF; }
    .link-label { font: 10px sans-serif; fill: #6B7280; }
    .box-label { font: bold 10px sans-serif; fill: #1F2937; }
  </style>

  <!-- Background -->
  <rect width="800" height="400" fill="#F9FAFB"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" class="title">Stream Links: Filter and Transform</text>

  <!-- Source Stream: orders-* -->
  <g transform="translate(50, 60)">
    <rect width="200" height="280" rx="8" fill="white" stroke="#3B82F6" stroke-width="2"/>
    <rect width="200" height="30" rx="8" fill="url(#sourceGrad)"/>
    <text x="100" y="22" text-anchor="middle" class="stream-title">Source: orders-*</text>

    <!-- Events -->
    <rect x="10" y="45" width="180" height="28" rx="4" fill="#DBEAFE"/>
    <text x="100" y="63" text-anchor="middle" class="event">OrderPlaced $500</text>

    <rect x="10" y="80" width="180" height="28" rx="4" fill="#E5E7EB"/>
    <text x="100" y="98" text-anchor="middle" class="event-filtered">OrderPlaced $50</text>

    <rect x="10" y="115" width="180" height="28" rx="4" fill="#DBEAFE"/>
    <text x="100" y="133" text-anchor="middle" class="event">OrderPlaced $1200</text>

    <rect x="10" y="150" width="180" height="28" rx="4" fill="#E5E7EB"/>
    <text x="100" y="168" text-anchor="middle" class="event-filtered">OrderCancelled</text>

    <rect x="10" y="185" width="180" height="28" rx="4" fill="#DBEAFE"/>
    <text x="100" y="203" text-anchor="middle" class="event">OrderPlaced $800</text>

    <rect x="10" y="220" width="180" height="28" rx="4" fill="#E5E7EB"/>
    <text x="100" y="238" text-anchor="middle" class="event-filtered">OrderPlaced $200</text>
  </g>

  <!-- Link Worker (Filter + Transform) -->
  <g transform="translate(300, 120)">
    <rect width="200" height="160" rx="8" fill="white" stroke="#8B5CF6" stroke-width="2"/>
    <rect width="200" height="30" rx="8" fill="url(#linkGrad)"/>
    <text x="100" y="22" text-anchor="middle" class="stream-title">Link: high-value-orders</text>

    <text x="15" y="55" class="box-label">Filter:</text>
    <text x="15" y="75" class="event">amount > 400</text>

    <text x="15" y="105" class="box-label">Transform:</text>
    <text x="15" y="125" class="event">add priority = high</text>
    <text x="15" y="145" class="event">add flagged_at = now()</text>
  </g>

  <!-- Target Stream -->
  <g transform="translate(550, 60)">
    <rect width="200" height="200" rx="8" fill="white" stroke="#10B981" stroke-width="2"/>
    <rect width="200" height="30" rx="8" fill="url(#targetGrad)"/>
    <text x="100" y="22" text-anchor="middle" class="stream-title">$link:high-value-orders</text>

    <!-- Filtered events -->
    <rect x="10" y="45" width="180" height="35" rx="4" fill="#D1FAE5"/>
    <text x="100" y="60" text-anchor="middle" class="event">OrderPlaced $500</text>
    <text x="100" y="75" text-anchor="middle" class="event" fill="#059669">priority: high</text>

    <rect x="10" y="90" width="180" height="35" rx="4" fill="#D1FAE5"/>
    <text x="100" y="105" text-anchor="middle" class="event">OrderPlaced $1200</text>
    <text x="100" y="120" text-anchor="middle" class="event" fill="#059669">priority: high</text>

    <rect x="10" y="135" width="180" height="35" rx="4" fill="#D1FAE5"/>
    <text x="100" y="150" text-anchor="middle" class="event">OrderPlaced $800</text>
    <text x="100" y="165" text-anchor="middle" class="event" fill="#059669">priority: high</text>
  </g>

  <!-- Arrows -->
  <line x1="250" y1="100" x2="295" y2="160" stroke="#8B5CF6" stroke-width="2" marker-end="url(#linkArrow)"/>
  <line x1="250" y1="145" x2="295" y2="180" stroke="#8B5CF6" stroke-width="2" marker-end="url(#linkArrow)"/>
  <line x1="250" y1="215" x2="295" y2="210" stroke="#8B5CF6" stroke-width="2" marker-end="url(#linkArrow)"/>

  <line x1="500" y1="180" x2="545" y2="120" stroke="#10B981" stroke-width="2" marker-end="url(#linkArrow)"/>

  <!-- Legend -->
  <g transform="translate(550, 290)">
    <rect width="200" height="80" rx="6" fill="white" stroke="#E5E7EB"/>
    <text x="100" y="20" text-anchor="middle" class="box-label">Live Subscription</text>
    <text x="15" y="45" class="event">Links subscribe to source</text>
    <text x="15" y="65" class="event">Updates stream in real-time</text>
  </g>
</svg>
