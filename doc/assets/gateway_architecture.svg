<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="bg4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
    <filter id="shadow4" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <rect width="800" height="500" fill="url(#bg4)"/>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="22" font-weight="bold">reckon-gater Architecture</text>

  <!-- Client Apps -->
  <rect x="30" y="70" width="120" height="180" rx="8" fill="#0f3460" filter="url(#shadow4)"/>
  <text x="90" y="95" text-anchor="middle" fill="#e94560" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Client Apps</text>

  <rect x="45" y="110" width="90" height="30" rx="4" fill="#533483"/>
  <text x="90" y="130" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">App 1</text>

  <rect x="45" y="150" width="90" height="30" rx="4" fill="#533483"/>
  <text x="90" y="170" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">App 2</text>

  <rect x="45" y="190" width="90" height="30" rx="4" fill="#533483"/>
  <text x="90" y="210" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">App 3</text>

  <!-- Gateway Box -->
  <rect x="180" y="70" width="440" height="400" rx="10" fill="#0a2540" filter="url(#shadow4)"/>
  <text x="400" y="95" text-anchor="middle" fill="#4ade80" font-family="Arial, sans-serif" font-size="14" font-weight="bold">reckon-gater</text>

  <!-- Worker Registry -->
  <rect x="200" y="110" width="180" height="100" rx="6" fill="#166534" filter="url(#shadow4)"/>
  <text x="290" y="135" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Worker Registry</text>
  <text x="290" y="155" text-anchor="middle" fill="#4ade80" font-family="Arial, sans-serif" font-size="9">pg-based (OTP)</text>

  <rect x="215" y="165" width="150" height="35" rx="4" fill="#0f3460"/>
  <text x="290" y="180" text-anchor="middle" fill="#888" font-family="monospace" font-size="8">store_a → [node1, node2]</text>
  <text x="290" y="193" text-anchor="middle" fill="#888" font-family="monospace" font-size="8">store_b → [node2, node3]</text>

  <!-- Retry Logic -->
  <rect x="400" y="110" width="200" height="100" rx="6" fill="#7c2d12" filter="url(#shadow4)"/>
  <text x="500" y="135" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Retry with Backoff</text>
  <text x="500" y="155" text-anchor="middle" fill="#f97316" font-family="Arial, sans-serif" font-size="9">Exponential + Jitter</text>

  <text x="420" y="175" fill="#888" font-family="Arial, sans-serif" font-size="8">Base: 100ms</text>
  <text x="420" y="190" fill="#888" font-family="Arial, sans-serif" font-size="8">Max: 5000ms</text>
  <text x="420" y="205" fill="#888" font-family="Arial, sans-serif" font-size="8">Attempts: 5</text>

  <!-- PubSub Channels -->
  <rect x="200" y="230" width="400" height="220" rx="6" fill="#0f3460" filter="url(#shadow4)"/>
  <text x="400" y="255" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">10 PubSub Channels</text>

  <!-- Critical channels -->
  <rect x="215" y="270" width="85" height="40" rx="4" fill="#dc2626"/>
  <text x="257" y="287" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8" font-weight="bold">CRITICAL</text>
  <text x="257" y="302" text-anchor="middle" fill="#fca5a5" font-family="Arial, sans-serif" font-size="7">alerts, security</text>

  <!-- High channels -->
  <rect x="310" y="270" width="85" height="40" rx="4" fill="#ea580c"/>
  <text x="352" y="287" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8" font-weight="bold">HIGH</text>
  <text x="352" y="302" text-anchor="middle" fill="#fdba74" font-family="Arial, sans-serif" font-size="7">events, health</text>

  <!-- Normal channels -->
  <rect x="405" y="270" width="85" height="40" rx="4" fill="#0284c7"/>
  <text x="447" y="287" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8" font-weight="bold">NORMAL</text>
  <text x="447" y="302" text-anchor="middle" fill="#7dd3fc" font-family="Arial, sans-serif" font-size="7">system, metrics</text>

  <!-- Low channels -->
  <rect x="500" y="270" width="85" height="40" rx="4" fill="#4b5563"/>
  <text x="542" y="287" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8" font-weight="bold">LOW</text>
  <text x="542" y="302" text-anchor="middle" fill="#9ca3af" font-family="Arial, sans-serif" font-size="7">logging, diag</text>

  <!-- Channel features -->
  <rect x="215" y="325" width="180" height="55" rx="4" fill="#1e3a5f"/>
  <text x="305" y="345" text-anchor="middle" fill="#4ade80" font-family="Arial, sans-serif" font-size="9" font-weight="bold">HMAC-SHA256 Security</text>
  <text x="305" y="362" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="8">Constant-time verification</text>
  <text x="305" y="375" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="8">5-minute message TTL</text>

  <rect x="405" y="325" width="180" height="55" rx="4" fill="#1e3a5f"/>
  <text x="495" y="345" text-anchor="middle" fill="#60a5fa" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Rate Limiting</text>
  <text x="495" y="362" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="8">Per topic per second</text>
  <text x="495" y="375" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="8">Configurable limits</text>

  <!-- Telemetry -->
  <rect x="215" y="395" width="370" height="40" rx="4" fill="#533483"/>
  <text x="400" y="415" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">BEAM Telemetry</text>
  <text x="400" y="428" text-anchor="middle" fill="#a78bfa" font-family="Arial, sans-serif" font-size="8">worker • request • retry • cluster • channel events</text>

  <!-- Event Stores -->
  <rect x="650" y="70" width="120" height="180" rx="8" fill="#166534" filter="url(#shadow4)"/>
  <text x="710" y="95" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Event Stores</text>

  <rect x="665" y="110" width="90" height="40" rx="4" fill="#0f3460"/>
  <text x="710" y="128" text-anchor="middle" fill="#4ade80" font-family="Arial, sans-serif" font-size="9">reckon-db</text>
  <text x="710" y="142" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="8">Node 1</text>

  <rect x="665" y="160" width="90" height="40" rx="4" fill="#0f3460"/>
  <text x="710" y="178" text-anchor="middle" fill="#4ade80" font-family="Arial, sans-serif" font-size="9">reckon-db</text>
  <text x="710" y="192" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="8">Node 2</text>

  <rect x="665" y="210" width="90" height="40" rx="4" fill="#0f3460"/>
  <text x="710" y="228" text-anchor="middle" fill="#4ade80" font-family="Arial, sans-serif" font-size="9">reckon-db</text>
  <text x="710" y="242" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="8">Node 3</text>

  <!-- Arrows -->
  <path d="M150 160 L175 160" stroke="#e94560" stroke-width="2" fill="none"/>
  <polygon points="175,157 182,160 175,163" fill="#e94560"/>

  <path d="M620 160 L645 160" stroke="#4ade80" stroke-width="2" fill="none"/>
  <polygon points="645,157 652,160 645,163" fill="#4ade80"/>

  <!-- Legend -->
  <text x="400" y="485" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="10">Gateway provides load balancing, service discovery, and pub/sub channels for distributed reckon-db access</text>
</svg>
